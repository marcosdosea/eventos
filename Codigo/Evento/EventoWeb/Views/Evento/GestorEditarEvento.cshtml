@model EventoWeb.Models.EventoModel

@{
	ViewData["Title"] = "GestorEditarEvento";
}

<h1 class="blue-normal">Gerir Evento</h1>
<div class="row">
	<form asp-action="GestorEditarEvento" enctype="multipart/form-data">
		<div asp-validation-summary="ModelOnly" class="text-danger"></div>
		<input type="hidden" asp-for="Id" />
		<div class="row">
			<div class="col-9">
				<div class="form-group">
					<label asp-for="Nome" class="control-label"></label>
					<input asp-for="Nome" class="form-control" placeholder="Nome do evento" />
					<span asp-validation-for="Nome" class="text-danger"></span>
				</div>
			</div>
			<div class="col-3">
				<div class="form-group">
					<label asp-for="IdTipoEvento" class="control-label">Tipo do Evento</label>
					<select asp-for="IdTipoEvento" class="form-select" asp-items="Model.TiposEventos">
						<option value="">Selecione o tipo de evento</option>
					</select>
					<span asp-validation-for="IdTipoEvento" class="text-danger"></span>
				</div>
			</div>
		</div>

		<br />
		<div class="form-group">
			<label asp-for="Descricao" class="control-label"></label>
			<textarea asp-for="Descricao" class="form-control" id="exampleFormControlTextarea1" rows="5"></textarea>
			<span asp-validation-for="Descricao" class="text-danger"></span>
		</div>
		<br />
		<div class="row">
			<div class="col-md-2">
				<div class="form-group">
					<label asp-for="DataInicio" class="control-label"></label>
					<input asp-for="DataInicio" class="form-control" />
					<span asp-validation-for="DataInicio" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2">
				<div class="form-group">
					<label asp-for="DataFim" class="control-label"></label>
					<input asp-for="DataFim" class="form-control" />
					<span asp-validation-for="DataFim" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2 align-content-end">
				<div class="form-group">
					<div class="d-flex">
						<div class="form-check">
							<!-- Checkbox que marca se a Inscrição é Gratuita(valor 1) -->
							<input class="form-check-input" type="checkbox" value="1" id="InscricaoGratuita" name="Evento.InscricaoGratuita"
							@(Model.InscricaoGratuita == 1 ? "checked" : "")>
							<label class="form-check-label" for="InscricaoGratuita">Inscricao Gratuita</label>
							<!-- Campo oculto para enviar valor 0 quando o checkbox não está marcado -->
							<input type="hidden" name="Evento.InscricaoGratuita" value="0">
						</div>
					</div>
					<span asp-validation-for="EventoPublico" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2 align-content-end">
				<div class="form-group">
					<div class="d-flex">
						<div class="form-check">
							<!-- Checkbox que marca se o Evento é Público (valor 1) -->
							<input class="form-check-input" type="checkbox" value="1" id="EventoPublico" name="Evento.EventoPublico"
							@(Model.EventoPublico == 1 ? "checked" : "")>
							<label class="form-check-label" for="EventoPublico">Evento Publico</label>
							<!-- Campo oculto para enviar valor 0 quando o checkbox não está marcado -->
							<input type="hidden" name="Evento.EventoPublico" value="0">
						</div>
					</div>
					<span asp-validation-for="EventoPublico" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2 align-content-end">
				<div class="form-group">
					<div class="d-flex ">
						<div class="form-check">
							<!-- Checkbox que marca se o evento Possui Certificado (valor 1) -->
							<input class="form-check-input" type="checkbox" value="1" id="PossuiCertificado" name="Evento.PossuiCertificado"
							@(Model.PossuiCertificado == 1 ? "checked" : "")>
							<label class="form-check-label" for="PossuiCertificado">Possui Certificado </label>
							<!-- Campo oculto para enviar valor 0 quando o checkbox não está marcado -->
							<input type="hidden" name="Evento.PossuiCertificado" value="0">
						</div>
					</div>
					<span asp-validation-for="PossuiCertificado" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="col-2">
				<div class="form-group">
					<label asp-for="Status" class="control-label"></label>
					<select asp-for="Status" class="form-select" aria-label="Default select example">
						<option value="C">Cadastro</option>
						<option value="A">Ativo</option>
						<option value="F">Finalizado</option>
						<option value="I">Inativo</option>
					</select>
					<span asp-validation-for="Status" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2">
				<div class="form-group">
					<label asp-for="DataInicioInscricao" class="control-label"></label>
					<input asp-for="DataInicioInscricao" class="form-control" />
					<span asp-validation-for="DataInicioInscricao" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-2">
				<div class="form-group">
					<label asp-for="DataFimInscricao" class="control-label"></label>
					<input asp-for="DataFimInscricao" class="form-control" />
					<span asp-validation-for="DataFimInscricao" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="form-group">
			<label asp-for="Website" class="control-label"></label>
			<input asp-for="Website" class="form-control" placeholder="Site do evento" />
			<span asp-validation-for="Website" class="text-danger"></span>
		</div>
		<br />
		<div class="form-group">
			<label asp-for="EmailEvento" class="control-label">E-mail</label>
			<input asp-for="EmailEvento" class="form-control" placeholder="E-mail para contato do evento" />
			<span asp-validation-for="EmailEvento" class="text-danger"></span>
		</div>
		<br />
		<div class="row">
			<div class="col-md-3">
				<div class="form-group">
					<label asp-for="Cep" class="control-label"></label>
					<input asp-for="Cep" class="form-control" />
					<span asp-validation-for="Cep" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-9">
				<div class="form-group">
					<label asp-for="Rua" class="control-label"></label>
					<input asp-for="Rua" class="form-control" />
					<span asp-validation-for="Rua" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="col-md-9">
				<div class="form-group">
					<label asp-for="Bairro" class="control-label"></label>
					<input asp-for="Bairro" class="form-control" />
					<span asp-validation-for="Bairro" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-group">
					<label asp-for="Numero" class="control-label"></label>
					<input asp-for="Numero" class="form-control" />
					<span asp-validation-for="Numero" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="col-md-9">
				<div class="form-group">
					<label asp-for="Cidade" class="control-label"></label>
					<input asp-for="Cidade" class="form-control" />
					<span asp-validation-for="Cidade" class="text-danger"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-group">
					<label asp-for="Estado" class="control-label"></label>
					<select asp-for="Estado" class="form-select" asp-items="Model.Estados">
						<option value="">Selecione o estado</option>
					</select>
					<span asp-validation-for="Estado" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="col-md-12">
				<div class="form-group">
					<label asp-for="Complemento" class="control-label"></label>
					<input asp-for="Complemento" class="form-control" />
					<span asp-validation-for="Complemento" class="text-danger"></span>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="col-3">
				<div class="form-group" id="FrequenciaMinimaCertificado">
					<label asp-for="FrequenciaMinimaCertificado" class="control-label">Frequência Min.</label>
					<input asp-for="FrequenciaMinimaCertificado" class="form-control" onkeypress="return validateInput(event)" />
					<span asp-validation-for="FrequenciaMinimaCertificado" class="text-danger"></span>
				</div>
			</div>
			<div class="col-3">
				<div class="form-group">
					<label asp-for="CargaHoraria" class="control-label"></label>
					<input asp-for="CargaHoraria" class="form-control" />
					<span asp-validation-for="CargaHoraria" class="text-danger"></span>
				</div>
			</div>
			<div class="col-3">
				<div class="form-group">
					<label asp-for="VagasOfertadas" class="control-label"></label>
					<input asp-for="VagasOfertadas" class="form-control" />
					<span asp-validation-for="VagasOfertadas" class="text-danger"></span>
				</div>
			</div>
			<div class="row">
				<div class="col-3">
					<div class="form-group" id="TempoMinutosReserva">
						<label asp-for="TempoMinutosReserva" class="control-label">Bloqueio de Reserva de Vaga (Minutos)</label>
						<input type="text" asp-for="TempoMinutosReserva" class="form-control" onkeypress="return validateInput(event)">
						<span asp-validation-for="TempoMinutosReserva" class="text-danger"></span>
					</div>
				</div>
				<div class="col-3">
					<div class="form-group" id="valorInscricaoGroup">
						<label asp-for="ValorInscricao" class="control-label">Valor da Inscrição</label>
						<input type="text" asp-for="ValorInscricao" class="form-control" onkeypress="return validateInput(event)">
						<span asp-validation-for="ValorInscricao" class="text-danger"></span>
					</div>
				</div>
			</div>
			<div class="col-5 form-group">
				<label asp-for="ImagemPortal" class="control-label"></label>
				<input type="file" asp-for="ImagemPortal" class="form-control" accept=".png,.jpg,.jpeg,.gif,.tif" id="fileInput" />
				<span asp-validation-for="ImagemPortal" class="text-danger"></span>
			</div>
		</div>
		<br />
		<div>
			<div class="form-group">
				<label class="control-label">Área de Interesse</label>
				<select id="areaInteresseSelect" class="form-control">
					<option value="">Selecione uma área de interesse</option>
					@foreach (var area in Model.AreaInteresse)
					{
						<option value="@area.Value">@area.Text</option>
					}
				</select>
				<button type="button" id="addAreaButton" class="btn btn-primary mt-2">Adicionar</button>
				<ul id="selectedAreas" class="mt-2 list-group">
					<!-- Itens selecionados serão exibidos aqui -->
				</ul>
				<span asp-validation-for="IdAreaInteresses" class="text-danger"></span>
			</div>
		</div>
		<br />
		<div class="d-flex justify-content-end">
			<div class="form-group" style="margin-right: 10px;">
				<input type="submit" value="Salvar" class="btn btn-blue-normal color-white" />
			</div>
			<div class="form-group">
				<a asp-controller="Evento" asp-action="GerenciarEvento" asp-route-idEvento="@Model..Id" class="btn btn-outline-danger">Voltar</a>
			</div>
		</div>
	</form>
</div>

@section Scripts {
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}
	<script>
		document.getElementById('InscricaoGratuita').addEventListener('change', function () {
			this.nextElementSibling.value = this.checked ? 1 : 0; // Ajusta o valor do campo oculto baseado no estado do checkbox
		});
	</script>
	<script>
		document.getElementById('EventoPublico').addEventListener('change', function () {
			this.nextElementSibling.value = this.checked ? 1 : 0; // Ajusta o valor do campo oculto baseado no estado do checkbox
		});
	</script>
	<script>
		document.getElementById('PossuiCertificado').addEventListener('change', function () {
			this.nextElementSibling.value = this.checked ? 1 : 0; // Ajusta o valor do campo oculto baseado no estado do checkbox
		});
	</script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		$(document).ready(function () {
			var areaInteresseSelect = $('#areaInteresseSelect');
			var selectedAreasList = $('#selectedAreas');

			function addHiddenInput(value) {
				var hiddenInput = $('<input type="hidden" name="IdAreaInteresses[]" value="' + value + '" />');
				selectedAreasList.append(hiddenInput);
			}

			$('#addAreaButton').on('click', function () {
				var selectedOption = areaInteresseSelect.find('option:selected');
				var value = selectedOption.val();
				var text = selectedOption.text();

				if (value && !selectedAreasList.find('[data-id="' + value + '"]').length) {
					var listItem = $('<li class="list-group-item d-flex justify-content-between align-items-center"></li>');
					listItem.text(text);
					listItem.attr('data-id', value);

					var removeButton = $('<button type="button" class="btn btn-danger btn-sm">Remover</button>');
					removeButton.on('click', function () {
						listItem.remove();
						$('input[value="' + value + '"]').remove();
					});

					listItem.append(removeButton);
					selectedAreasList.append(listItem);

					// Adiciona o campo oculto correspondente
					addHiddenInput(value);

					// Remove a seleção do dropdown após adicionar
					areaInteresseSelect.val('');
				}
			});
		});
	</script>



}